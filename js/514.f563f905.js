"use strict";(self["webpackChunkwork_project_v3"]=self["webpackChunkwork_project_v3"]||[]).push([[514],{1149:function(t,e,s){s.d(e,{Z:function(){return h}});var a=s(7808),i=function(){var t=this,e=t._self._c;return e(a.Z,{attrs:{"prepend-icon":"fa-solid fa-magnifying-glass",placeholder:"Search..."},on:{input:t.search}})},r=[],n={props:{dataForFilter:{type:Array,default:()=>[]},searchKey:{type:String,default:""}},data(){return{filtredData:[]}},methods:{search(t){this.filtredData=this.dataForFilter.filter((e=>e[this.searchKey].includes(t))),this.$emit("onFilter",this.filtredData)}}},l=n,o=s(1001),c=(0,o.Z)(l,i,r,!1,null,null,null),h=c.exports},1826:function(t,e,s){s.r(e),s.d(e,{default:function(){return Z}});var a=s(3423),i=s(4562),r=s(9223),n=s(4324),l=s(5256),o=(s(7658),function(){var t=this,e=t._self._c;return e("div",{staticClass:"center"},[e("div",{staticClass:"button__inner"},[e("button-vue",{staticClass:"button",attrs:{color:"white"},on:{click:function(e){return t.$router.push("/new-template")}}},[t._v(" Создать ")])],1),e("div",{staticClass:"container"},[e("div",{staticClass:"wrapper"},[t.templatesOrigin.length?t._e():e("div",{staticClass:"empty_list"},[t._v(" Список пуст ")]),e("div",{staticClass:"search-bar"},[e("BaseSearchBar",{attrs:{"data-for-filter":t.templates,"search-key":"template_name"},on:{onFilter:t.onFilterHandle}})],1),e(l.Z,{attrs:{items:t.templatesOrigin,"item-height":70,height:"800px"},scopedSlots:t._u([{key:"default",fn:function({item:s}){return[e("div",{staticClass:"list_item"},[e("div",{staticClass:"list_item__block_info"},[e(a.Z,{attrs:{color:t.getColor(s.template_name)}},[e("div",[t._v(t._s(t.getFirstLetter(s.template_name)))])]),e("button",{staticClass:"block_info__name",on:{click:function(e){return t.openModal(s)}}},[t._v(" "+t._s(s.template_name)+" ")])],1),e("div",{staticClass:"list_item__additional d-flex"},[e("div",{staticClass:"list_item__info"},[e("span",{staticClass:"list_item__time"},[t._v(t._s(t.dayjs(s.created_at).format("DD.MM.YYYY hh:mm:ss")))]),e("pre",[t._v(t._s(s.status))])]),e("div",[e(i.Z,{attrs:{elevation:"2",icon:"",plain:""},on:{click:function(e){return t.deleteTemplate(s)}}},[e(n.Z,{attrs:{color:"red"}},[t._v(" mdi-trash-can ")])],1)],1)])])]}}])}),e("BaseModal",{attrs:{open:t.open,title:"Детали шаблона"},on:{onModalClose:t.onCloseModalHandle}},[e("template",{slot:"content"},[e("div",{staticClass:"pa-5"},[e("div",[e("h3",[t._v("Данные шаблона")]),e("div",[e("div",[e("span",[t._v("Тип шаблона:")]),e("span",[t._v(t._s(t.selectedItem?.edna_shortcut?.messageMatcher?.type))])]),e("div",[e("span",[t._v("Название шаблона:")]),e("span",[t._v(t._s(t.selectedItem?.template_name))])]),e("div",[e("span",[t._v("Категория шаблона:")]),e("span",[t._v(t._s(t.selectedItem?.edna_shortcut?.messageMatcher?.category))])]),e("div",[e("span",[t._v("Язык шаблона:")]),e("span",[t._v(t._s(t.selectedItem?.edna_shortcut?.messageMatcher?.language))])])])]),e(r.Z),e("div",[e("h3",[t._v("Заголовок")]),"TEXT"===t.selectedItem?.edna_shortcut?.messageMatcher?.content?.header?.headerType?e("div",[e("span",[t._v(t._s(t.selectedItem?.edna_shortcut?.messageMatcher?.content?.header?.headerType)+":")]),e("span",[t._v(t._s(t.selectedItem?.edna_shortcut?.messageMatcher?.content?.header?.text))])]):t._e(),t.selectedItem?.edna_shortcut?.messageMatcher?.content?.header?.headerExampleMediaUrl?e("div",[e("span",[t._v(t._s(t.selectedItem?.edna_shortcut?.messageMatcher?.content?.header?.headerType)+":")]),e("img",{staticClass:"img_example",attrs:{src:t.selectedItem?.edna_shortcut?.messageMatcher?.content?.header?.headerExampleMediaUrl}})]):t._e()]),e(r.Z),e("div",[e("h3",[t._v("Текст шаблона")]),e("div",[e("p",[t._v("Текст и порядок строк символов в шаблоне регистрируются у оператора как пример исходящего сообщения. Подставляйте конкретные переменные или необходимый текст вместо строк символов в пользовательском шаблоне и используйте его для рассылок вашим клиентам.")])]),e("span",[t._v(t._s(t.selectedItem?.edna_shortcut?.messageMatcher?.content?.header?.text))])]),e(r.Z),e("div",{staticClass:"mt-4"},[e("span",[t._v("Время создания:")]),e("span",[t._v(t._s(t.dayjs(t.selectedItem.timestamp).format("DD.MM.YYYY hh:mm:ss")))])])],1)])],2),e("vue-element-loading",{attrs:{active:t.isLoading,"background-color":"rgba(255, 255, 255, 1)",color:"blue"}})],1)])])}),c=[],h=s(4110),d=s(629),m=s(1149),u=s(5067),_=s(7978),p=s(4402),v=s(7484),g=s.n(v),f=s(2581),C={components:{BaseModal:u.Z,BaseSearchBar:m.Z,ButtonVue:_.Z},mixins:[h.Z,f.Z],data:()=>({isLoading:!1,open:!1,selectedItem:{},templatesOrigin:[]}),computed:{...(0,d.Se)(["getTemplates"]),templates(){return this.getTemplates}},watch:{templates(t){this.templatesOrigin=[...t]}},created(){this.getData()},methods:{getData(t=this.$route.params.userId){this.isLoading=!1;const e={};t&&(e.username=t),p.t.get("get/messages/matcher").then((t=>{const e=t.data,s=e.sort(((t,e)=>new Date(e.date)-new Date(t.date)));this.$store.commit("setTemplate",s.reverse())})).catch((t=>{this.$toast.error(t.message,{timeout:2e3})})).finally((()=>{this.isLoading=!1}))},dayjs:g(),onCloseModalHandle(){this.selectedItem={},this.open=!1},onFilterHandle(t){this.templatesOrigin=t},openModal(t){this.selectedItem=t,this.open=!0},deleteTemplate(t){p.t["delete"](`get/messages/matcher/${t.edna_template_id}`).then((()=>{this.$toast.info("Шаблон успешно удален"),this.templatesOrigin=this.templatesOrigin.filter((e=>e.edna_template_id!==t.edna_template_id))})).catch((t=>{this.$toast.error(t.message,{timeout:2e3})}))}}},y=C,b=s(1001),M=(0,b.Z)(y,o,c,!1,null,"6a94b512",null),Z=M.exports},3423:function(t,e,s){s.d(e,{Z:function(){return o}});var a=s(6878),i=s(8846),r=s(2637),n=s(5352),l=s(7678),o=(0,l.Z)(a.Z,i.Z,r.Z).extend({name:"v-avatar",props:{left:Boolean,right:Boolean,size:{type:[Number,String],default:48}},computed:{classes(){return{"v-avatar--left":this.left,"v-avatar--right":this.right,...this.roundedClasses}},styles(){return{height:(0,n.kb)(this.size),minWidth:(0,n.kb)(this.size),width:(0,n.kb)(this.size),...this.measurableStyles}}},render(t){const e={staticClass:"v-avatar",class:this.classes,style:this.styles,on:this.$listeners};return t("div",this.setBackgroundColor(this.color,e),this.$slots.default)}})},9223:function(t,e,s){s.d(e,{Z:function(){return i}});var a=s(6669),i=a.Z.extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render(t){let e;return this.$attrs.role&&"separator"!==this.$attrs.role||(e=this.vertical?"vertical":"horizontal"),t("hr",{class:{"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical,...this.themeClasses},attrs:{role:"separator","aria-orientation":e,...this.$attrs},on:this.$listeners})}})},5256:function(t,e,s){s.d(e,{Z:function(){return c}});var a=s(8846);function i(t,e,s){const{self:a=!1}=e.modifiers||{},i=e.value,r="object"===typeof i&&i.options||{passive:!0},n="function"===typeof i||"handleEvent"in i?i:i.handler,l=a?t:e.arg?document.querySelector(e.arg):window;l&&(l.addEventListener("scroll",n,r),t._onScroll=Object(t._onScroll),t._onScroll[s.context._uid]={handler:n,options:r,target:a?void 0:l})}function r(t,e,s){var a;if(!(null===(a=t._onScroll)||void 0===a?void 0:a[s.context._uid]))return;const{handler:i,options:r,target:n=t}=t._onScroll[s.context._uid];n.removeEventListener("scroll",i,r),delete t._onScroll[s.context._uid]}const n={inserted:i,unbind:r};var l=n,o=s(5352),c=a.Z.extend({name:"v-virtual-scroll",directives:{Scroll:l},props:{bench:{type:[Number,String],default:0},itemHeight:{type:[Number,String],required:!0},items:{type:Array,default:()=>[]}},data:()=>({first:0,last:0,scrollTop:0}),computed:{__bench(){return parseInt(this.bench,10)},__itemHeight(){return parseInt(this.itemHeight,10)},firstToRender(){return Math.max(0,this.first-this.__bench)},lastToRender(){return Math.min(this.items.length,this.last+this.__bench)}},watch:{height:"onScroll",itemHeight:"onScroll"},mounted(){this.last=this.getLast(0)},methods:{getChildren(){return this.items.slice(this.firstToRender,this.lastToRender).map(this.genChild)},genChild(t,e){e+=this.firstToRender;const s=(0,o.kb)(e*this.__itemHeight);return this.$createElement("div",{staticClass:"v-virtual-scroll__item",style:{top:s},key:e},(0,o.z9)(this,"default",{index:e,item:t}))},getFirst(){return Math.floor(this.scrollTop/this.__itemHeight)},getLast(t){const e=parseInt(this.height||0,10)||this.$el.clientHeight;return t+Math.ceil(e/this.__itemHeight)},onScroll(){this.scrollTop=this.$el.scrollTop,this.first=this.getFirst(),this.last=this.getLast(this.first)}},render(t){const e=t("div",{staticClass:"v-virtual-scroll__container",style:{height:(0,o.kb)(this.items.length*this.__itemHeight)}},this.getChildren());return t("div",{staticClass:"v-virtual-scroll",style:this.measurableStyles,directives:[{name:"scroll",modifiers:{self:!0},value:this.onScroll}],on:this.$listeners},[e])}})},2581:function(t,e){e["Z"]={methods:{getColor(t){const e=["#F46A5F","#FC8256","#FFC33D","#49BEB7","#4C96D7","#8555D7","#FF7DCC","#D4C5F9","#4992E6","#FF6B8A","#01A9DB","#B6FCD5"];let s=0;for(let i=0;i<t.length;i++)s=t.charCodeAt(i)+((s<<5)-s);const a=Math.abs(s)%e.length;return e[a]},getFirstLetter(t){return t&&t.length>0?t.charAt(0):""}}}}}]);
//# sourceMappingURL=514.f563f905.js.map